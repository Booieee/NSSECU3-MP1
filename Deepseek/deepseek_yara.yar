/*
YARA rules generated from extracted_bytes.csv
Based on GCK's File Signatures Table (https://www.garykessler.net/library/file_sigs_GCK_latest.html)
Rules match on the first 50 bytes of each file as provided
*/

rule FileType_MSDOS_EXE {
    meta:
        description = "MS-DOS executable file (EXE), OS/2 EXE, or DLL"
        reference = "https://www.garykessler.net/library/file_sigs_GCK_latest.html"
        file_extension = "EXE, DLL, CPL, SYS, OCX, SCR, VXD"
        hex_signature = "4D5A"
    strings:
        $magic = { 4D5A90000300000004000000FFFF0000B8000000000000004000000000000000000000000000000000000000000000000000 }
    condition:
        $magic
}

rule FileType_UTF8_BOM_Text {
    meta:
        description = "UTF-8 encoded text file with BOM"
        reference = "https://www.garykessler.net/library/file_sigs_GCK_latest.html"
        file_extension = "TXT, various"
        hex_signature = "EF BB BF"
    strings:
        $magic = { EFBBBF3C230A2E53594E4F505349530A09496E7374616C6C73205A6F6F6D0A2E4445534352495054494F4E0A095468697320 }
    condition:
        $magic
}

rule FileType_Copyright_Text {
    meta:
        description = "Text file containing copyright statement - likely plain text"
        reference = "Generic text file"
        notes = "Contains 'Copyright (c)' ASCII text"
    strings:
        $magic = { 436F7079726967687420286329205B796561725D205B66756C6C6E616D655D0D0A0D0A54686520556E6976657273616C2050 }
    condition:
        $magic
}

rule FileType_Batch_Script {
    meta:
        description = "Windows Batch script"
        reference = "Batch file signature - starts with '@echo off' or similar commands"
        file_extension = "BAT, CMD"
    strings:
        $magic1 = { 406563686F206F66660D0A736574202F61206C696E653D2572616E646F6D252025252035202B20310D0A666F72202F662022 }
        $magic2 = { 406563686F206F66660D0A736574202F6120636F756E743D2572616E646F6D25202525203230202B20310D0A6563686F2047 }
        $magic3 = { 406563686F206F66660D0A736574202F61206865783D2572616E646F6D25202525203235350D0A736574202F612068657832 }
        $magic4 = { 406563686F206F66660D0A736574202F6120646965313D2572616E646F6D252025252036202B20310D0A736574202F612064 }
        $magic5 = { 406563686F206F66660D0A666F72202F662022746F6B656E733D312D342064656C696D733D2F20222025256120696E202822 }
        $magic6 = { 406563686F206F66660D0A736574202F61206E756D3D2572616E646F6D252025252031303030300D0A6563686F20596F7572 }
        $magic7 = { 406563686F206F66660D0A73657420696E7075743D68656C6C6F0D0A7365742072657665727365643D0D0A666F72202F6C20 }
        $magic8 = { 406563686F206F66660D0A7365746C6F63616C20656E61626C6564656C61796564657870616E73696F6E0D0A73657420776F }
        $magic9 = { 406563686F206F66660D0A736574202F6120636F6C6F723D2572616E646F6D252025252031360D0A636F6C6F722025636F6C }
        $magic10 = { 406563686F206F66660D0A736574202F612064656C61793D2572616E646F6D252025252035202B20310D0A74696D656F7574 }
        $magic11 = { 406563686F206F66660D0A7365742070617468733D433A5C57696E646F77735C20433A5C55736572735C20433A5C50726F67 }
        $magic12 = { 406563686F206F66660D0A736574202F61206E756D3D2572616E646F6D25202525203236202B2036350D0A666F72202F6620 }
        $magic13 = { 406563686F206F66660D0A666F72202F6C2025256920696E2028312C312C33322920646F20280D0A20202020736574202F61 }
        $magic14 = { 406563686F206F66660D0A6563686F2052616E646F6D20537472696E673A202572616E646F6D250D0A }
        $magic15 = { 406563686F206F66660D0A736574202F6120636F64653D2572616E646F6D25202525203235350D0A6563686F204578697469 }
        $magic16 = { 406563686F206F66660D0A7365742073656E74656E6365733D48656C6C6F7C486F772061726520796F753F7C4E6963652077 }
        $magic17 = { 406563686F206F66660D0A736574206D6573736167653D4C6F6164696E672072616E646F6D20746578742E2E2E0D0A666F72 }
        $magic18 = { 406563686F206F66660D0A736574202F6120613D2572616E646F6D25202525203130300D0A736574202F6120623D2572616E }
        $magic19 = { 406563686F206F66660D0A736574206164766963653D5374617920706F7369746976652E7C54616B6520627265616B732E7C }
        $magic20 = { 406563686F206F66660D0A73657420776F72643D68656C6C6F0D0A73657420736372616D626C65643D0D0A666F72202F6C20 }
    condition:
        any of ($magic*)
}

rule FileType_ZIP_PKZIP {
    meta:
        description = "ZIP archive or related format (PKZIP)"
        reference = "https://www.garykessler.net/library/file_sigs_GCK_latest.html"
        file_extension = "ZIP, DOCX, XLSX, PPTX, JAR, etc."
        hex_signature = "50 4B 03 04"
    strings:
        $magic_zip1 = { 504B03040A000000000000002100FFFFFFFF1102000011020000100000005B74726173685D2F303030302E646174FFFFFFFF }
        $magic_zip2 = { 504B030414000600080000002100D4A2463FD9010000EC0900001300D3015B436F6E74656E745F54797065735D2E786D6C20 }
        $magic_zip3 = { 504B0304140006000800000021003CF321F4570200009F1600001300C0015B436F6E74656E745F54797065735D2E786D6C20 }
        $magic_zip4 = { 504B03040A000000000000002100FFFFFFFF0F0200000F020000100000005B74726173685D2F303030302E646174FFFFFFFF }
        $magic_zip5 = { 504B03041400060008000000210004E86306F70100009B0A0000130008025B436F6E74656E745F54797065735D2E786D6C20 }
        $magic_zip6 = { 504B030414000600080000002100E4A7B06FEB010000350D0000130008025B436F6E74656E745F54797065735D2E786D6C20 }
        $magic_zip7 = { 504B03040A000000000000002100FFFFFFFF0D0200000D020000100000005B74726173685D2F303030302E646174FFFFFFFF }
        $magic_zip8 = { 504B03040A000000000000002100FFFFFFFF6402000064020000100000005B74726173685D2F303030302E646174FFFFFFFF }
        $magic_zip9 = { 504B0304140006000800000021009884F0A8EB010000220A00001300CA015B436F6E74656E745F54797065735D2E786D6C20 }
        $magic_zip10 = { 504B030414000600080000002100E679A397BA0100007D0D0000130008025B436F6E74656E745F54797065735D2E786D6C20 }
        $magic_zip11 = { 504B030414000000080000002100610DD4924202000075140000130000005B436F6E74656E745F54797065735D2E786D6CCC }
        $magic_zip12 = { 504B03040A000000000000002100FFFFFFFF3502000035020000100000005B74726173685D2F303030302E646174FFFFFFFF }
        $magic_zip13 = { 504B03041400020008004A247659FB70553B11530000494E030011001100776F72642F646F63756D656E742E786D6C55540D }
        $magic_zip14 = { 504B03040A000000000000002100FFFFFFFFF3010000F3010000100000005B74726173685D2F303030302E646174FFFFFFFF }
        $magic_zip15 = { 504B03040A000000000000002100FFFFFFFF2D0200002D020000100000005B74726173685D2F303030302E646174FFFFFFFF }
        $magic_zip16 = { 504B0304140008080800AB0B765900000000000000000000000010000000776F72642F686561646572312E786D6CCD96DB8E }
        $magic_zip17 = { 504B030414000600080000002100B5CF3E7B02010000BB0200000B00ED015F72656C732F2E72656C7320A2E90128A0000200 }
        $magic_zip18 = { 504B0304140006000800000021008FBFF13623040000C54E0000130008025B436F6E74656E745F54797065735D2E786D6C20 }
        $magic_zip19 = { 504B0304140006000800000021009D7C732AE3010000B50C0000130008025B436F6E74656E745F54797065735D2E786D6C20 }
        $magic_zip20 = { 504B03041400060008000000210081717D3CF8010000BA0C00001300CD015B436F6E74656E745F54797065735D2E786D6C20 }
        $magic_zip21 = { 504B030414000600080000002100D571953EE10100007A090000130008025B436F6E74656E745F54797065735D2E786D6C20 }
        $magic_zip22 = { 504B0304140006000800000021001E27607088010000AE050000130008025B436F6E74656E745F54797065735D2E786D6C20 }
        $magic_zip23 = { 504B0304140006000800000021002B54510ED9020000A62400001300BA015B436F6E74656E745F54797065735D2E786D6C20 }
        $magic_zip24 = { 504B030414000600080000002100458C023ABC010000640800001300DC015B436F6E74656E745F54797065735D2E786D6C20 }
        $magic_zip25 = { 504B0304140006000800000021007476540CD00100006C0B0000130008025B436F6E74656E745F54797065735D2E786D6C20 }
        $magic_zip26 = { 504B0304140006000800000021009CBD3CE3CE010000C40B0000130008025B436F6E74656E745F54797065735D2E786D6C20 }
        $magic_zip27 = { 504B0304140006000800000021009F04C7C538020000541000001300C2015B436F6E74656E745F54797065735D2E786D6C20 }
        $magic_zip28 = { 504B030414000808080048A5755900000000000000000000000012000000776F72642F6E756D626572696E672E786D6CED9B }
        $magic_zip29 = { 504B0304140006000800000021003D578734C6010000BF080000130008025B436F6E74656E745F54797065735D2E786D6C20 }
        $magic_zip30 = { 504B030414000600080000002100A674045285010000AC070000130008025B436F6E74656E745F54797065735D2E786D6C20 }
        $magic_zip31 = { 504B03040A00000008000000210003E47BFEC703000091130000140000007070742F70726573656E746174696F6E2E786D6C }
        $magic_zip32 = { 504B03040A000000000000002100FFFFFFFF1C0200001C020000100000005B74726173685D2F303030302E646174FFFFFFFF }
        $magic_zip33 = { 504B030414000600080000002100FFBF187A2E020000570D00001300C2015B436F6E74656E745F54797065735D2E786D6C20 }
        $magic_zip34 = { 504B0304140008080800CE13765900000000000000000000000010000000776F72642F666F6F746572312E786D6CED57FF6E }
        $magic_zip35 = { 504B03040A000000000000002100FFFFFFFF2002000020020000100000005B74726173685D2F303030302E646174FFFFFFFF }
        $magic_zip36 = { 504B030414000600080000002100B7BBC7DCA402000000250000130008025B436F6E74656E745F54797065735D2E786D6C20 }
        $magic_zip37 = { 504B0304140008080800BABB755500000000000000000000000010000000786C2F636F6D6D656E7473312E786D6C8D53CB6E }
        $magic_zip38 = { 504B030414000600080000002100B5CF3E7B02010000BB0200000B0008025F72656C732F2E72656C7320A2040228A0000200 }
        $magic_zip39 = { 504B030414000600080000002100A404CFE97101000098050000130008025B436F6E74656E745F54797065735D2E786D6C20 }
        $magic_zip40 = { 504B030414000600080000002100C3AA5D0E8D020000581D0000130008025B436F6E74656E745F54797065735D2E786D6C20 }
        $magic_zip41 = { 504B03041400060008000000210033A54B358A01000099050000130008025B436F6E74656E745F54797065735D2E786D6C20 }
        $magic_zip42 = { 504B0304140000080800423D3C5A479244B25A010000F0040000130004005B436F6E74656E745F54797065735D2E786D6C53 }
        $magic_zip43 = { 504B0304140006000800000021001CADB2D2FA0100006D0B0000130008025B436F6E74656E745F54797065735D2E786D6C20 }
        $magic_zip44 = { 504B0304140006000800000021009634826862020000281800001300C5015B436F6E74656E745F54797065735D2E786D6C20 }
        $magic_zip45 = { 504B030414000600080000002100B5F6D3968D01000021070000130008025B436F6E74656E745F54797065735D2E786D6C20 }
        $magic_zip46 = { 504B030414000600080000002100885E620BCA010000220A0000130008025B436F6E74656E745F54797065735D2E786D6C20 }
        $magic_zip47 = { 504B03041400060008000000210058793607DF010000230A0000130008025B436F6E74656E745F54797065735D2E786D6C20 }
        $magic_zip48 = { 504B03040A000000000000002100FFFFFFFF0C0200000C020000100000005B74726173685D2F303030302E646174FFFFFFFF }
        $magic_zip49 = { 504B0304140006000800000021003E1188CA6002000047190000130008025B436F6E74656E745F54797065735D2E786D6C20 }
        $magic_zip50 = { 504B03041400060008000000210062EE9D685E01000090040000130008025B436F6E74656E745F54797065735D2E786D6C20 }
        $magic_zip51 = { 504B0304140008080800D241755900000000000000000000000010000000776F72642F686561646572312E786D6CA595DB8E }
        $magic_zip52 = { 504B03041400060008000000210099557E05F9000000E10200000B00F3015F72656C732F2E72656C7320A2EF0128A0000200 }
        $magic_zip53 = { 504B03040A000000080000002100FC1FED11250200004305000010000000646F6350726F70732F6170702E786D6C9C54DF6F }
        $magic_zip54 = { 504B0304140006000800000021003BF479E32E030000B810000014000000786C2F70726573656E746174696F6E2E786D6CEC }
        $magic_zip55 = { 504B03041400060008000000210024EC50BF8201000024070000130008025B436F6E74656E745F54797065735D2E786D6C20 }
    condition:
        any of ($magic_zip*)
}

rule FileType_PNG_Image {
    meta:
        description = "Portable Network Graphics (PNG) image"
        reference = "https://www.garykessler.net/library/file_sigs_GCK_latest.html"
        file_extension = "PNG"
        hex_signature = "89 50 4E 47 0D 0A 1A 0A"
    strings:
        $magic_png1 = { 89504E470D0A1A0A0000000D4C454E5A00000388000004EC0806000000C272AC0C0001000049444154789CECFD799C6DD975 }
        $magic_png2 = { 89504E470D0A1A0A0000000D4948445200000388000004EC0806000000C272AC0C0001000049444154789CECFD5993243992 }
        $magic_png3 = { 89504E470D0A1A0A0000000D4948445200000388000004EC0806000000C272AC0C0001000049444154789CECFD79B025D719 }
        $magic_png4 = { 89504E470D0A1A0A0000000D4948445200000388000004EC0806000000C272AC0C0001000049444154789CECFD69B0655976 }
        $magic_png5 = { 89504E470D0A1A0A0000000D4948445200000388000004EC0806000000C272AC0C0001000049444154789CECFDE992244B92 }
        $magic_png6 = { 89504E470D0A1A0A0000000D4948445200000388000004EC0806000000C272AC0C0001000049444154789CECFD67B465C975 }
        $magic_png7 = { 89504E470D0A1A0A0000000D4948445200000388000004EC0806000000C272AC0C0001000049444154789CECFD77B025C976 }
        $magic_png8 = { 89504E470D0A1A0A0000000D4948445200000388000004EC0806000000C272AC0C0001000049444154789CECFD69B06DC975 }
        $magic_png9 = { 89504E470D0A1A0A0000000D4948445200000388000004EC0806000000C272AC0C0001000049444154789CECFDE9B36DC775 }
        $magic_png10 = { 89504E470D0A1A0A0000000D4948445200000388000004EC0806000000C272AC0C0001000049444154789CECFD69B11649921D }
        $magic_png11 = { 89504E470D0A1A0A0000000D4948445200000388000004EC0806000000C272AC0C0001000049444154789CECFD799F6D5976 }
        $magic_png12 = { 89504E470D0A1A0A0000000D4948445200000388000004EC0806000000C272AC0C0001000049444154789CECFD69BC6DD975 }
        $magic_png13 = { 89504E470D0A1A0A0000000D4948445200000388000004EC0806000000C272AC0C0001000049444154789CECFD69B125D975 }
        $magic_png14 = { 89504E470D0A1A0A0000000D4948445200000388000004EC0806000000C272AC0C0001000049444154789CECFDF993245B76 }
        $magic_png15 = { 89504E470D0A1A0A0000000D4948445200000388000004EC0806000000C272AC0C0001000049444154789CECFDE9B22C4992 }
        $magic_png16 = { 89504E470D0A1A0A0000000D4948445200000388000004EC0806000000C272AC0C0001000049444154789CECFD69B16CD975 }
        $magic_png17 = { 89504E470D0A1A0A0000000D4948445200000388000004EC0806000000C272AC0C0001000049444154789CECFD69A825D971 }
        $magic_png18 = { 89504E470D0A1A0AE000104A46494600010100000100010000FFDB004300080606070605080707070909080A0C140D0C0B0B }
        $magic_png19 = { 89504E470D0A1A0A0000000D4948445200000388000004EC0806000000C272AC0C0001000049444154789CECFD49B3654B76 }
        $magic_png20 = { 89504E470D0A1A0A0000000D4948445200000388000004EC0806000000C272AC0C0001000049444154789CECFD699725C971 }
        $magic_png21 = { 89504E470D0A1A0A0000000D4948445200000388000004EC0806000000C272AC0C0001000049444154789CECFD69AC6DBD75 }
        $magic_png22 = { 89504E470D0A1A0A0000000D4948445200000388000004EC0806000000C272AC0C0001000049444154789CECFDF98F245B96 }
        $magic_png23 = { 89504E470D0A1A0A0000000D4948445200000388000004EC0806000000C272AC0C0001000049444154789CECFDE9B36DD8F9 }
        $magic_png24 = { 89504E470D0A1A0A0000000D4948445200000388000004EC0806000000C272AC0C0001000049444154789CECFD69B06DC9F5 }
        $magic_png25 = { 89504E470D0A1A0A0000000D4948445200000388000004EC0806000000C272AC0C0001000049444154789CECFD69A86CD9F5 }
    condition:
        any of ($magic_png*)
}

rule FileType_JPEG_JFIF {
    meta:
        description = "JPEG/JFIF image file"
        reference = "https://www.garykessler.net/library/file_sigs_GCK_latest.html"
        file_extension = "JPG, JPEG, JPE, JFIF"
        hex_signature = "FF D8 FF"
    strings:
        $magic_jpg1 = { FFD8FFE100104A46494600010100000100010000FFDB004300080606070605080707070909080A0C140D0C0B0B0C1912130F }
        $magic_jpg2 = { FFD8FFE000104A46494600010100000100010000FFDB004300080606070605080707070909080A0C140D0C0B0B0C1912130F }
        $magic_jpg3 = { FFD8FFE000104A46494600010100000100010000FFDB004300080606070605080707070909080A0C140D0C0B0B0C1912130F }
        $magic_jpg4 = { FFD8FF0000000D4948445200000388000004EC0806000000C272AC0C0001000049444154789CECFD599324499226887DCC22 }
        $magic_jpg5 = { FFD8FFE000104558494600010100000100010000FFDB004300080606070605080707070909080A0C140D0C0B0B0C1912130F }
        $magic_jpg6 = { FFD9FFE000104A46494600010100000100010000FFDB004300080606070605080707070909080A0C140D0C0B0B0C1912130F }
    condition:
        any of ($magic_jpg*)
}

rule FileType_PDF_Document {
    meta:
        description = "Adobe Portable Document Format (PDF)"
        reference = "https://www.garykessler.net/library/file_sigs_GCK_latest.html"
        file_extension = "PDF"
        hex_signature = "25 50 44 46"
    strings:
        $magic_pdf1 = { 255044462D312E350A25F6E4FCDF0A312030206F626A0A3C3C0A2F54797065202F436174616C6F670A2F5061676573203220 }
        $magic_pdf2 = { 255044462D312E370A25F6E4FCDF0A312030206F626A0A3C3C0A2F50616765732032203020520A2F54797065202F43617461 }
        $magic_pdf3 = { 255044462D312E330A25E2E3CFD30A312030206F626A0A3C3C0A2F54797065202F50616765730A2F436F756E742033330A2F }
        $magic_pdf4 = { 255044462D312E340A25F6E4FCDF0A312030206F626A0A3C3C0A2F54797065202F436174616C6F670A2F56657273696F6E20 }
        $magic_pdf5 = { 255044462D312E330A25E2E3CFD30A312030206F626A0A3C3C0A2F54797065202F50616765730A2F436F756E742032300A2F }
        $magic_pdf6 = { 255044462D312E350D0A25B5B5B5B50D0A312030206F626A0D0A3C3C2F547970652F436174616C6F672F5061676573203220 }
        $magic_pdf7 = { 255044462D312E330A25E2E3CFD30A312030206F626A0A3C3C0A2F54797065202F50616765730A2F436F756E742031340A2F }
        $magic_pdf8 = { 255044462D312E360D25E2E3CFD30D0A3433312030206F626A0D3C3C2F4C696E656172697A656420312F4C20353838313532 }
        $magic_pdf9 = { 255044462D312E370D25E2E3CFD30D0A312030206F626A0A3C3C2F4163726F466F726D2035203020522F4C616E6728656E29 }
        $magic_pdf10 = { 255044462D312E370A25E2E3CFD30A312030206F626A0A3C3C2F436F6C6F7253706163652F446576696365477261792F5375 }
        $magic_pdf11 = { 255044462D312E340D25E2E3CFD30D0A313231332030206F626A0D3C3C2F4C696E656172697A656420312F4C203439303836 }
        $magic_pdf12 = { 255044462D312E370D0A25B5B5B5B50D0A312030206F626A0D0A3C3C2F547970652F436174616C6F672F5061676573203220 }
    condition:
        any of ($magic_pdf*)
}

rule FileType_MS_Compound_OOXML {
    meta:
        description = "Microsoft Office Open XML Format (OOXML) - Word document"
        reference = "https://www.garykessler.net/library/file_sigs_GCK_latest.html"
        file_extension = "DOCX, DOTX, DOCM"
        hex_signature = "50 4B 03 04 - with word/ document"
    strings:
        $magic_docx1 = { 504B03041400020008004A247659FB70553B11530000494E030011001100776F72642F646F63756D656E742E786D6C55540D }
        $magic_docx2 = { 4344303014000600080000002100A990C0AD7B030000D3100000140000007070742F70726573656E746174696F6E2E786D6C }
    condition:
        $magic_docx1 or $magic_docx2
}

rule FileType_ID3_Tag {
    meta:
        description = "ID3 tag (metadata container for MP3 files)"
        reference = "https://www.garykessler.net/library/file_sigs_GCK_latest.html"
        file_extension = "MP3"
        hex_signature = "49 44 33"
    strings:
        $magic_id3_1 = { 49443300010100000008001000FFFF0800000100000000000040000000000000000000000000000000000000000000000000 }
        $magic_id3_2 = { 494433312E340D258084888C9094989CA0A4A8ACB0B4B8BCC0C4C8CCD0D4D8DCE0E4E8ECF0F4F8FC0D0D312030206F626A0D }
    condition:
        any of ($magic_id3_*)
}

rule FileType_GPL_License_Text {
    meta:
        description = "GNU General Public License (GPL) text file"
        reference = "Plain text license file"
        notes = "Contains GPL header text"
    strings:
        $magic_gpl1 = { 2020202020202020202020202020202020202020474E552041464645524F2047454E4552414C205055424C4943204C494345 }
        $magic_gpl2 = { 2020202020202020202020202020202020202020474E552047454E4552414C205055424C4943204C4943454E53450D0A2020 }
        $magic_gpl3 = { 202020202020202020202020444F205748415420544845204655434B20594F552057414E5420544F205055424C4943204C49 }
        $magic_gpl4 = { 2020202020202020202020202020202020202020474E55204C45535345522047454E4552414C205055424C4943204C4943454E }
        $magic_gpl5 = { 426F6F737420536F667477617265204C6963656E7365202D2056657273696F6E20312E30202D204175677573742031377468 }
        $magic_gpl6 = { 54686973206973206672656520616E6420756E656E63756D626572656420736F6674776172652072656C656173656420696E }
        $magic_gpl7 = { 4D6F7A696C6C61205075626C6963204C6963656E73652056657273696F6E20322E300D0A3D3D3D3D3D3D3D3D3D3D3D3D3D3D }
        $magic_gpl8 = { 4F70656E20536F667477617265204C6963656E73652028224F534C222920762E20332E300D0A0D0A54686973204F70656E20 }
        $magic_gpl9 = { 41636164656D69632046726565204C6963656E736520282241464C222920762E20332E300D0A0D0A54686973204163616465 }
        $magic_gpl10 = { 202020202020202020202020202020202020202020204555524F5045414E20554E494F4E205055424C4943204C4943454E43 }
        $magic_gpl11 = { 425344205A65726F20436C61757365204C6963656E73650D0A0D0A436F7079726967687420286329205B796561725D205B66 }
        $magic_gpl12 = { 4D6963726F736F6674205075626C6963204C6963656E736520284D732D504C290D0A0D0A54686973206C6963656E73652067 }
        $magic_gpl13 = { 090920202020202020546865204172746973746963204C6963656E736520322E300D0A0D0A0920202020436F707972696768 }
        $magic_gpl14 = { 4D004900540020004C006900630065006E00730065000D000A000D000A0043006F0070007900720069006700680074002000 }
        $magic_gpl15 = { 450063006C00690070007300650020005000750062006C006900630020004C006900630065006E007300650020002D002000 }
        $magic_gpl16 = { 45006400750063006100740069006F006E0061006C00200043006F006D006D0075006E0069007400790020004C0069006300 }
    condition:
        any of ($magic_gpl*)
}

rule FileType_SYNopsis_Script {
    meta:
        description = "SYNOPSIS script/configuration file"
        reference = "Custom script format - contains SYNOPSIS header"
        notes = "Starts with EF BB BF 3C 23 0A 2E 53 59 4E 4F 50 53 49 53 (UTF-8 BOM + '<#.SYNOPSIS')"
    strings:
        $magic_synopsis1 = { EFBBBF3C230A2E53594E4F505349530A095072696E747320746865204D443520636865636B73756D206F6620612066696C65 }
        $magic_synopsis2 = { EFBBBF3C230A2E53594E4F505349530A095072696E74732074686520534841312068617368206F6620612066696C650A2E44 }
        $magic_synopsis3 = { EFBBBF3C230A2E53594E4F505349530A09496E7374616C6C7320626173696320617070730A2E4445534352495054494F4E0A }
        $magic_synopsis4 = { EFBBBF3C230A2E53594E4F505349530A09496E7374616C6C732047697420666F722057696E646F77730A2E44455343524950 }
        $magic_synopsis5 = { EFBBBF3C230A2E53594E4F505349530A09456E61626C65732074686520676F64206D6F64650A2E4445534352495054494F4E }
        $magic_synopsis6 = { EFBBBF3C230A2E53594E4F505349530A09496E7374616C6C73204368726F6D650A2E4445534352495054494F4E0A09546869 }
        $magic_synopsis7 = { EFBBBF3C230D0A2E53594E4F505349530D0A2020202020202020496E7374616C6C732043686F636F6C6174657920286E6565 }
        $magic_synopsis8 = { EFBBBF3C230A2E53594E4F505349530A095072696E747320746865205348413531322068617368206F6620612066696C650A }
        $magic_synopsis9 = { EFBBBF3C230A2E53594E4F505349530A09496E7374616C6C7320564C430A2E4445534352495054494F4E0A09546869732050 }
        $magic_synopsis10 = { EFBBBF3C230A2E53594E4F505349530A09496E7374616C6C73204E6574666C69780A2E4445534352495054494F4E0A095468 }
        $magic_synopsis11 = { EFBBBF3C230A2E53594E4F505349530A095072696E747320746865205348413235362068617368206F6620612066696C650A }
        $magic_synopsis12 = { EFBBBF3C230A2E53594E4F505349530A09496E7374616C6C73204F42532053747564696F20286E656564732061646D696E20 }
        $magic_synopsis13 = { EFBBBF3C230A2E53594E4F505349530A09496E7374616C6C732056697375616C2053747564696F20436F64650A2E44455343 }
        $magic_synopsis14 = { EFBBBF3C230A2E53594E4F505349530A09496E7374616C6C732047697420457874656E73696F6E730A2E4445534352495054 }
        $magic_synopsis15 = { EFBBBF3C230A2E53594E4F505349530A09496E7374616C6C7320446973636F72640A2E4445534352495054494F4E0A095468 }
        $magic_synopsis16 = { EFBBBF3C230A2E53594E4F505349530A09496E7374616C6C732053706F746966790A2E4445534352495054494F4E0A095468 }
        $magic_synopsis17 = { EFBBBF3C230A2E53594E4F505349530A09496E7374616C6C7320547769747465720A2E4445534352495054494F4E0A095468 }
        $magic_synopsis18 = { EFBBBF3C230A2E53594E4F505349530A09496E7374616C6C73205468756E646572626972640A2E4445534352495054494F4E }
        $magic_synopsis19 = { EFBBBF3C230A2E53594E4F505349530A09496E7374616C6C73205A6F6F6D0A2E4445534352495054494F4E0A095468697320 }
    condition:
        any of ($magic_synopsis*)
}

rule FileType_Unicode_UTF32_BE_BOM {
    meta:
        description = "UTF-32/UCS-4 text, big-endian with BOM"
        reference = "https://www.garykessler.net/library/file_sigs_GCK_latest.html"
        hex_signature = "00 00 FE FF"
    strings:
        $magic = { 4100740074007200690062007500740069006F006E00200034002E003000200049006E007400650072006E00610074006900 }
    condition:
        $magic
}

rule FileType_WAVE_RIFF {
    meta:
        description = "WAVE audio file (RIFF)"
        reference = "https://www.garykessler.net/library/file_sigs_GCK_latest.html"
        file_extension = "WAV"
        hex_signature = "52 49 46 46 xx xx xx xx 57 41 56 45"
    strings:
        $magic_wav1 = { 52494646574156452D312E360D25E2E3CFD30D0A35392030206F626A203C3C2F4C696E656172697A656420312F4C20313936 }
        $magic_wav2 = { 52494646574156452D312E330A25E2E3CFD30A312030206F626A0A3C3C0A2F54797065202F50616765730A2F436F756E7420 }
    condition:
        any of ($magic_wav*)
}

rule FileType_CDR_CorelDRAW {
    meta:
        description = "CorelDRAW vector graphics file (CDR)"
        reference = "https://www.garykessler.net/library/file_sigs_GCK_latest.html"
        file_extension = "CDR"
        hex_signature = "43 44 52"
    strings:
        $magic_cdr1 = { 4344303014000600080000002100AAF758A47901000014060000130008025B436F6E74656E745F54797065735D2E786D6C20 }
        $magic_cdr2 = { 43443030312E360A25F6E4FCDF0A312030206F626A0A3C3C0A2F4D657461646174612032203020520A2F4C616E672028656E }
        $magic_cdr3 = { 4344303014000600080000002100714B4E1205020000EC0C00001300CD015B436F6E74656E745F54797065735D2E786D6C20 }
    condition:
        any of ($magic_cdr*)
}

rule FileType_Invalid_NonHex {
    meta:
        description = "Invalid or non-hexadecimal data in signature field"
        notes = "Contains exponential notation or invalid hex characters"
    strings:
        $invalid1 = "2.0002E+99"
        $invalid2 = { FFFB90000300000004000000FFFF0000B8000000000000004000000000000000000000000000000000000000000000000000 }
        $invalid3 = { 4D5A00010100000008001000FFFF080000010000000000004000000000000000000000000000000000000000000000000000 }
        $invalid4 = { 4D5A50000200000004000F00FFFF0000B80000000000000040001A0000000000000000000000000000000000000000000000 }
        $invalid5 = { 4D5A8B000300000020000000FFFF070000016540000000004000000001000000000000000000000000000000000000000000 }
        $invalid6 = { 4D5A93000300000020000000FFFF070000016540000000004000000001000000000000000000000000000000000000000000 }
        $invalid7 = { 42000200000020000000FFFF05000001000000000000400000000100FB716A72000000000000000000000000000000000000 }
        $invalid8 = { 90000300000004000000FFFF0000B80000000000000040000000000000000000000000000000000000000000000000000000 }
    condition:
        any of ($invalid*)
}

rule FileType_Unknown_Binary {
    meta:
        description = "Unknown binary format or file fragment"
        notes = "No matching signature in GCK table"
    strings:
        $unknown1 = { 5B4C6F63616C697A656446696C654E616D65735D0D0A62696F6368656D5F6D65642D32332D322D3134332D332E7064663D40 }
        $unknown2 = { 495343204C6963656E73650D0A0D0A436F7079726967687420286329205B796561725D205B66756C6C6E616D655D0D0A0D0A }
        $unknown3 = { 0A22312E20496E7374616C6C20616E6420636F6E66696775726520746865206E656365737361727920646570656E64656E63 }
    condition:
        any of ($unknown*)
}